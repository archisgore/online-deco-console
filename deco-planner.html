<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
	<meta charset="utf-8">
	<title>Online REPL Javascript Dive Planner</title>
	<meta name="description" content="Online web-based REPL Javascript programmatic scuba diving decompression planner." />
	<meta name="keywords" content="javascript, console, sandbox, repl, scuba diving, buhlmann, programmatic, decompression" />
	<link rel="canonical" href="http://deco-planner.archisgore.com" />
	<link href="http://cdn.alloyui.com/3.0.1/aui-css/css/bootstrap.min.css" rel="stylesheet"/>
</head>

<body>
<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-56982159-3', 'auto');
  ga('send', 'pageview');

</script>

	<!-- HTML -->
	
	<h1>Online Programmatic Javascript Dive Planner (With GUI)</h1>

	<h2>A javascript console to programmatically compute dive plans.</h2>
	
	<div class="content">


		<div id="topLevelTabs">

			<ul class="nav nav-tabs">
				<li class="active"><a href="#tab-gui-planner">GUI Planner</a></li>
				<li><a href="#tab-javascript-editor">Javascript Editor</a></li>
				<li><a href="#tab-repl-console">REPL Console</a></li>
			</ul>

			<div class="tab-content">
				<div id="tab-gui-planner" class="tab-pane">
				</div>
				<div id="tab-javascript-editor">
					<div id="javascriptEditor"></div>
                    <button id="executeFromEditor"></button>

                    <pre id="javascriptEditorOutputScrollNode" style="overflow-y: scroll; height: 300px">
                        <h4 id="javascriptEditorResults">Results</h4>
                        <pre id="javascriptEditorResultsText"></pre>
                        <h4 id="javascriptEditorOutput">Console Output</h4>
                        <pre id="javascriptEditorConsoleOutputText"></pre>
                    </div>

				</div>
				<div id="tab-repl-console" class="tab-pane">
				</div>
			</div>

		</div>

		<p>Maintained by <strong><a href="http://archisgore.com" title="Archis Gore" target="_blank">Archis Gore</a> </strong></p>
		<p>You can haz source code! <a href="https://github.com/archisgore/online-deco-console" title="online programmatic javascript dive planner">Online Dive Planner console github repo</a>.</p>
	</div>

<!-- Scripts -->
	<script src="http://cdn.alloyui.com/3.0.1/aui/aui-min.js"></script>
    <script src="src/scuba-dive.browserified.js"></script>

	<script type="text/javascript">

        var dive = require("/scuba-dive.js");

        var consoleShim = {
            log: function (m) {
                this.capturedText = this.capturedText + '\n' + m;
            },
            capturedText: ""
        };

        function Evaluator(console) {
            var that = this;

            that.evalHelper = function (str) {
                that.evalHelper = function (str) {
                    try {
                        return JSON.stringify(eval(str));
                    } catch (e) {
                        return e.toString();
                    }
                };
            };
        }
        Evaluator.prototype.evaluate = function (str) {
            return this.evalHelper(str);
        };

        var evaluator = new Evaluator(consoleShim);

		YUI().use(
				'aui-tabview',
				function(Y) {
					new Y.TabView(
							{
								srcNode: '#topLevelTabs'
							}
					).render();
				}
		);

        YUI().use(
                'aui-ace-editor',
                function(Y) {
                    var editor = new Y.AceEditor(
                            {
                                boundingBox: '#javascriptEditor',
                                height: '200',
                                value: '',
                                width: '900',
                                mode: "javascript",
                                enableBasicAutocompletion: true
                            }
                    ).render();

                    var executeEditorButton = Y.one("#executeFromEditor");
                    var jsResultsText = Y.one("#javascriptEditorResultsText");
                    var jsConsoleOutputText = Y.one("#javascriptEditorConsoleOutputText");
                    executeEditorButton.on(
                            'click',
                            function(event) {
                                var editorjs = editor.get("value");
                                var result = evaluator.evaluate(editorjs);
                                jsResultsText.set("innerText", result);
                                jsConsoleOutputText.set("innerText", consoleShim.capturedText);
                                consoleShim.capturedText = "";
                            }
                    );

                }
        );

        YUI().use(
                'aui-button',
                function(Y) {
                    new Y.Button(
                            {
                                icon: 'icon-print',
                                iconAlign: 'left',
                                label: 'Execute Code',
                                srcNode: '#executeFromEditor'
                            }
                    ).render();

                }
        );

	</script>
</body>
</html>
